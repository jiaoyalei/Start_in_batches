import requests,collections

# stop_vm = ['2524', '2525', '2526', '2527', '2529', '2530', '2533', '2534', '2535', '2536', '2537', '2538', '2539', '2540', '2542', '2543', '2545', '2548', '2550', '2551', '2552', '2553', '2554', '2555', '2556', '2557', '2558', '2560', '2561', '2562', '2563', '2564', '2565', '2566', '2567', '2568', '2569', '2573', '2575', '2576', '2577', '2578', '2580', '2582', '2584', '2585', '2586', '2587', '2588', '2589', '2590', '2592', '2593', '2594', '2595', '2596', '2597', '2598', '2599', '2600', '2601', '2602', '2603', '2604', '2605', '2606', '2607', '2608', '2609', '2610', '2612', '2614', '2615', '2616', '2617', '2618', '2619', '2620', '2621', '2623']
stop_vm = ['3231', '3233', '3234', '3236', '3238', '3240', '3242', '3244', '3249', '3250', '3253', '3257', '3259', '3265', '3267', '3268', '3270', '3272', '3277', '3278', '3279', '3280', '3283', '3284', '3285', '3288', '3290', '3291', '3293', '3296', '3297', '3298', '3299', '3300', '3301', '3302', '3303', '3304', '3305', '3306']
real_count = 0
not_open_vm = []
cloud_count = []
for i in stop_vm:
    re = requests.post(r"http://192.168.234.80:18080/nvmp/stop/%s" %i)
    value = re.json()
    print(value)
    try:
        print("%s:"%i,value['msg'])
        not_open_vm.append(i)
    except :
        print("%s:"%i,value['data'])
        real_count +=1
        cloud_count.append(value['data'][5:14])
print("实际关机数量：%d,未正常开机%d台，vmid:%s" %(real_count,len(not_open_vm),not_open_vm))
dic = collections.Counter(cloud_count)
for key in dic:
    print("%s节点下->%d台虚机" %(key,dic[key]))